import { listenForMessage, sendMessage, service } from "../router";

const htmlEl = document.documentElement;

export type language = "en" | "de";

export enum textId {
  sources,
  unknown_source,
  author,
  title,
  creation_date,
  last_access,
  link,
  export_pdf,
  download_pdf,
  start_new_session,
  stop_session,
  add_source,
  delete_source,
  edit_source,
  use_source,
  last_accessed_at,
  find,
  replace,
  replace_all,
  find_and_replace,
  not_found,
  show_help,
  rename_file,
  download_file,
  print,
  switch_code_render,
  toggle_display_render,
  zoom_in,
  zoom_out,
  shortcut,
  description,
  set_language,
  untitled,
  unknown,
  table_of_contents,
  table_of_figures,
  figure,
  guest_user,
  line,
  column,
  selected,
  words,
  theme,
  ocean,
  lime,
  magma,
  tutorial_0,
  tutorial_1,
  tutorial_2,
  tutorial_3,
  tutorial_4,
  tutorial_5,
  tutorial_6,
  tutorial_7,
  tutorial_8,
  yes,
  no,
  next,
  file_too_big,
  exit_confirm,
  header_text,
}

const future = new Date().getFullYear() + 24;

const localStringMap: { [key in language]: { [key in textId]: string } } = {
  de: [
    /* sources */ "Einzelnachweise",
    /* unknown_source */ "Quelle unbekannt",
    /* author */ "Autor",
    /* title */ "Titel",
    /* creation_date */ "Erstellungsdatum",
    /* last_access */ "Letzter Zugriff",
    /* link */ "Link",
    /* export_pdf */ "PDF exportieren",
    /* download_pdf */ "PDF herunterladen",
    /* start_new_session */ "Sitzung starten",
    /* stop_session */ "Sitzung beenden",
    /* add_source */ "Quelle hinzufügen",
    /* delete_source */ "Quelle löschen",
    /* edit_source */ "Quelle bearbeiten",
    /* use_source */ "Quelle verlinken",
    /* last_accessed_at */ "Zuletzt zugegriffen am",
    /* find */ "Suchen",
    /* replace */ "Ersetzen",
    /* replace_all */ "Alle ersetzen",
    /* find_and_replace */ "Suchen und ersetzen",
    /* not_found */ "Nicht gefunden",
    /* show_help */ "Hilfe anzeigen",
    /* rename_file */ "Datei umbenennen",
    /* download_file */ "Datei herunterladen, öffnen per drag & drop",
    /* print */ "Drucken",
    /* switch_code_render */ "Wechsle zwischen Code- und Anzeigemodus",
    /* toggle_display_render */ "Schalte Anzeigemodus neben Codeanzeige an oder aus",
    /* zoom_in */ "Anzeige vergrößern",
    /* zoom_out */ "Anzeige verkleinern",
    /* shortcut */ "Tastenkürzel",
    /* description */ "Beschreibung",
    /* set_language */ "Sprache ändern",
    /* untitled */ "Unbenannt",
    /* unknown */ "unbekannt",
    /* table_of_contents */ "Inhaltsverzeichnis",
    /* table_of_figures */ "Abbildungsverzeichnis",
    /* figure */ "Abbildung",
    /* guest_user */ "Gastbenutzer",
    /* line */ "Zeile",
    /* column */ "Spalte",
    /* selected */ "Ausgewählt",
    /* words */ "Wörter",
    /* theme */ "Design",
    /* ocean */ "Ozean",
    /* lime */ "Limette",
    /* magma */ "Magma",
    /* tutorial_0 */ "Möchtest Du die Anleitung zu docdown starten? Du kannst sie auch später über den Fragezeichen-Button am unteren Bildschirmrand starten.",
    /* tutorial_1 */ `Mein Name ist Dr. Marc Down, diese Technologie habe ich aus dem Jahr ${future} mitgebracht! Ich erkläre Dir das notwendigste kurz und knapp. Hoffentlich brennen Dir bei der folgenden Erklärung nicht die Schaltkreise durch!`,
    /* tutorial_2 */ "In dem Textfeld in der Mitte des Fensters kannst Du Deine Dokumentation in Markdown schreiben, Markdown ist auch in diesem Jahr schon bekannt, oder?",
    /* tutorial_3 */ "Auf der rechten Seite wird Dir eine Vorschau Deiner Dokumentation angezeigt. Erst beim Export wird ein Inhalts- und Quellenverzeichnis generiert.",
    /* tutorial_4 */ "Mit der Tastenkombination STRG E kannst Du zwischen der Markdown und der Vorschau-Anzeige wechseln, mit STRG &#8679; E wird die Vorschauanzeige neben dem Code an- oder ausgeschaltet. Versuch es doch gleich mal!",
    /* tutorial_5 */ "Über das Rechtsklick-Menü kann das Dokument zu PDF exportiert oder ganz altmodisch gedruckt werden.",
    /* tutorial_6 */ "Unten links befindet sich eine Liste deiner Quellen. Über das Rechtsklick-Menü kannst Du eine Quelle hinzufügen, löschen oder bearbeiten.\nUm eine Quelle zu verwenden, klicke zuerst im Markdown-Editor an die gewünschte Stelle und wähle danach eine Quelle aus der Liste aus.\nUm eine verwendete Quelle wieder zu entfernen, lösche einfach den src Tag im Markdown.",
    /* tutorial_7 */ "Verwende die F1 Taste, um die Hilfe zu öffnen, dort findest Du einige sehr nützliche Tastenkürzel.",
    /* tutorial_8 */ "Das war’s erst mal, ich muss jetzt zurück in die Zukunft, bis bald!",
    /* yes */ "Ja",
    /* no */ "Nein",
    /* next */ "Weiter",
    /* file_too_big */ "Die Datei ist zu groß!",
    /* exit_confirm */ "Möchtest Du das Programm wirklich beenden?",
    /* header_text */ "Anmerkung im Header",
  ],
  en: [
    /* sources */ "References",
    /* unknown_source */ "Unknown source",
    /* author */ "Author",
    /* title */ "Title",
    /* creation_date */ "Creation date",
    /* last_access */ "Last access",
    /* link */ "Link",
    /* export_pdf */ "Export to PDF",
    /* download_pdf */ "Download PDF",
    /* start_new_session */ "Start a session",
    /* stop_session */ "Stop session",
    /* add_source */ "Add source",
    /* delete_source */ "Delete source",
    /* edit_source */ "Edit source",
    /* use_source */ "Use source",
    /* last_accessed_at */ "Last accessed at",
    /* find */ "Find",
    /* replace */ "Replace",
    /* replace_all */ "Replace all",
    /* find_and_replace */ "Find and replace",
    /* not_found */ "Not found",
    /* show_help */ "Show help",
    /* rename_file */ "Rename file",
    /* download_file */ "Download file, drag & drop to open",
    /* print */ "Print",
    /* switch_code_render */ "Switch between code and display mode",
    /* toggle_display_render */ "Toggle display mode beside code on or off",
    /* zoom_in */ "Zoom in",
    /* zoom_out */ "Zoom out",
    /* shortcut */ "Shortcut",
    /* description */ "Description",
    /* set_language */ "Set language",
    /* untitled */ "Untitled",
    /* unknown */ "unknown",
    /* table_of_contents */ "Table of contents",
    /* table_of_figures */ "Table of figures",
    /* figure */ "Figure",
    /* guest_user */ "Guest user",
    /* line */ "Line",
    /* column */ "Column",
    /* selected */ "Selected",
    /* words */ "Words",
    /* theme */ "Theme",
    /* ocean */ "Ocean",
    /* lime */ "Lime",
    /* magma */ "Magma",
    /* tutorial_0 */ "Would you like to learn how to use docdown? You can also do that later by clicking the question mark button at the bottom of the screen.",
    /* tutorial_1 */ `My name is Dr. Marc Down, I brought this technology from ${future}! I explain you the most necessary briefly and concisely. Hopefully the following explanation will not burn out your circuits!`,
    /* tutorial_2 */ "In the text field in the middle of the window you can write your documentation in Markdown, Markdown is already known this year, right?",
    /* tutorial_3 */ "On the right side you will see a preview of your documentation. A table of contents and a table of sources are generated during the export.",
    /* tutorial_4 */ "CTRL E lets you switch between the Markdown and preview display, CTRL &#8679; E toggles the preview display next to the code on or off.",
    /* tutorial_5 */ "Using the right-click menu, the document can be exported to PDF or printed the old-fashioned way.",
    /* tutorial_6 */ "At the bottom left is a list of your sources. Use the right-click menu to add, delete or edit a source.\nTo use a source, first click on the desired location in the Markdown editor and then select a source from the list.\nTo remove a used source, simply delete the src tag in Markdown.",
    /* tutorial_7 */ "Use the F1 key to open the help, there you will find some very useful keyboard shortcuts.",
    /* tutorial_8 */ "That's it for now, I have to get back to the future, see you soon!",
    /* yes */ "Yes",
    /* no */ "No",
    /* next */ "Next",
    /* file_too_big */ "The file is too big!",
    /* exit_confirm */ "Do you really want to quit?",
    /* header_text */ "Header text",
  ],
};

let currentLanguage: language;

listenForMessage(service.getLocale, () => currentLanguage);

listenForMessage(service.setLocale, (language) => {
  if (language in localStringMap) {
    currentLanguage = language;
    htmlEl.lang = language;
  } else {
    console.error(`Language "${language}" not supported`);
  }
});

sendMessage(service.setLocale, navigator.language.includes("de") ? "de" : "en");

export const getText = (id: textId) => localStringMap[currentLanguage][id];
